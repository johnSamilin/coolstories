(this.webpackJsonpforest=this.webpackJsonpforest||[]).push([[0],{119:function(t,e,n){t.exports=function(){return new Worker(n.p+"adad9c7d41097794a22d.worker.js")}},120:function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};e.__esModule=!0;var a=function(){function t(){this.q=new Map,this.highestPriority=0}return t.prototype.push=function(t,e){if(this.q.has(e)){var n=this.q.get(e)||[];n.push(t),this.q.set(e,n)}else this.q.set(e,[t]);e>this.highestPriority&&(this.highestPriority=e)},t.prototype.pop=function(){var t,e,n=this.q.get(this.highestPriority)||[],a=n.pop();if(0===n.length){this.q.delete(this.highestPriority);var i=this.q.keys(),s=0;try{for(var o=r(i),c=o.next();!c.done;c=o.next()){var u=c.value;u>s&&(s=u)}}catch(h){t={error:h}}finally{try{c&&!c.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.highestPriority=s}else this.q.set(this.highestPriority,n);return a},t.prototype.isEmpty=function(){return 0===this.q.size},t}();function i(t,e){return!!t.find((function(t){var n=t.x,r=t.y;return n===e.x&&r===e.y}))}function s(t,e,n){for(var r=n[0],a=n[1],s=[],o=Array.from(e.keys()),c=1;c>=-1;c--)for(var u=1;u>=-1;u--){var h={x:t.x-c,y:t.y-u};h.x===t.x&&h.y===t.y||(h.x<0||h.x>=r||h.y<0||h.y>=a||i(o,h)||0===n[2+(h.x*r+h.y)]&&s.push(h))}return s}function o(t,e){var n=Math.SQRT2-1,r=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);return 1/(r<a?n*r+a:n*a+r)}e.findPath=function(t,e,n,r,i){var c={x:e,y:n},u={x:r,y:i},h=new a,f=new Map,l=new Map;for(h.push(c,0),f.set(c,null),l.set(c,0);!h.isEmpty();){var d=h.pop();if(!d)break;if(d.x===u.x&&d.y===u.y){for(var p=f.get(d),m=[[d.x,d.y]];null!==p;)m.unshift([p.x,p.y]),p=f.get(p);for(var v=new Int8Array(2*m.length),g=0,y=0;y<m.length;y++){var b=m[y][0],w=m[y][1];v[g]=b,v[g+1]=w,g+=2}return v}var O=s(d,f,t);for(y=0;y<O.length;y++){var j=O[y],P=l.get(d)+1;if(!l.has(j)||l.get(j)>=P){l.set(j,P);var x=P+o(u,j);h.push(j,x),f.set(j,d)}}}return new Int8Array(0)}},132:function(t,e,n){t.exports=n(253)},136:function(t,e,n){},163:function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=163},167:function(t,e){},169:function(t,e){},201:function(t,e){},202:function(t,e){},247:function(t,e,n){},253:function(t,e,n){"use strict";n.r(e);var r,a,i=n(1),s=n.n(i),o=n(42),c=n.n(o),u=(n(136),n(11)),h=n.n(u),f=n(15),l=n(8),d=n(26),p=n(13),m=n(0),v=n(44),g=n(6),y=n(130),b=n(12),w=n(3),O=n(2),j=function t(e,n){Object(O.a)(this,t),this.x=void 0,this.y=void 0,this.age=void 0,this.x=e,this.y=n,this.age=1},P=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;Object(O.a)(this,t),this.initialTrees=void 0,this.seedRadius=5,this.seedDecay=.3,this.seedStrength=.1,this.desiredCoverage=.2,this.seed=7,this.width=void 0,this.height=void 0,this.forest=void 0,this.trees=[],this.seeds=new Map,this.height=e,this.width=n,this.initialTrees=r,this.forest=Array(n).fill(1),this.forest=this.forest.map((function(t){return Array(e).fill(1)}));for(var a=0;a<this.initialTrees;a++)for(;;){var i=Math.ceil(Math.random()*this.width),s=Math.ceil(Math.random()*this.height);if(1===this.forest[i][s]){this.forest[i][s]=2,this.addTree(i,s);break}}}return Object(w.a)(t,[{key:"generate",value:function(){for(var t=this.getCoverage();t<this.desiredCoverage;)this.step(),t=this.getCoverage();return this.removeSeeds(),this.trees}},{key:"removeSeeds",value:function(){var t,e=Object(b.a)(this.seeds.entries());try{for(e.s();!(t=e.n()).done;){var n=Object(l.a)(t.value,1)[0].split(",").map((function(t){return parseInt(t)})),r=Object(l.a)(n,2),a=r[0],i=r[1];this.forest[a][i]=1}}catch(s){e.e(s)}finally{e.f()}}},{key:"getCoverage",value:function(){var t=this.width*this.height;return this.trees.length/t}},{key:"addTree",value:function(t,e){this.trees.push(new j(t,e)),this.forest[t][e]=2}},{key:"step",value:function(){var t,e=new Map,n=Object(b.a)(this.seeds.entries());try{for(n.s();!(t=n.n()).done;){var r=Object(l.a)(t.value,2),a=r[0],i=r[1];e.set(a,i-this.seedDecay*i)}}catch(w){n.e(w)}finally{n.f()}this.seeds=e;var s,o=Object(b.a)(this.seeds.entries());try{for(o.s();!(s=o.n()).done;){var c=Object(l.a)(s.value,2),u=c[0],h=c[1];if(Math.random()<h){var f=u.split(",").map((function(t){return parseInt(t)})),d=Object(l.a)(f,2),p=d[0],m=d[1];this.addTree(p,m)}}}catch(w){o.e(w)}finally{o.f()}for(var v in this.trees=this.trees.map((function(t){return t.age++,t})),this.trees){var g=this.trees[v],y=g.x+","+g.y;this.seeds.has(y)&&this.seeds.delete(y)}this.seedTrees()}},{key:"seedTrees",value:function(){for(var t in this.trees)for(var e=this.trees[t],n=[Math.max(e.x-this.seedRadius,0),Math.min(e.x+this.seedRadius,this.width),Math.max(e.y-this.seedRadius,0),Math.min(e.y+this.seedRadius,this.height)],r=n[0],a=n[1],i=n[2],s=n[3],o=0;o<=2*e.age;o++){var c=Math.trunc(r+Math.random()*(a-r)),u=Math.trunc(i+Math.random()*(s-i));if(2!==this.forest[c][u]){this.forest[c][u]=3;var h=c+","+u,f=this.seeds.get(h)||0;this.seeds.set(h,f+this.seedStrength)}}}}]),t}(),x=n(57);function M(){return(M=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function E(t,e){var n=a.findPath(Math.trunc(t[2]/2),Math.trunc(t[0]/2),Math.trunc(e[2]/2),Math.trunc(e[0]/2),r.clone());return n.length,n}var k={initPathfinding:function(){return M.apply(this,arguments)},startPathFinding:function(t,e){return r=new x.Grid(t,e),a=new x.BiBestFirstFinder({heuristic:x.Heuristic.octile}),!0},setObstacles:function(t){return t.forEach((function(t){var e=t.x,n=t.y;r.setWalkableAt(n,e,!1)})),!0},findPath:E,findPathAsync:function(t,e){return new Promise((function(n){n(E(t,e))}))}},S=n(119),A=new(n.n(S).a);function F(){return(F=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _(){return(_=Object(f.a)(h.a.mark((function t(e,n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){A.postMessage({pathfinding:{operation:"findPath",payload:{from:e,to:n}}}),A.onmessage=function(e){e.data.pathfindingResult&&"findPath"===e.data.pathfindingResult.operation&&t(e.data.pathfindingResult.result)}})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var C={initPathfinding:function(){return F.apply(this,arguments)},startPathFinding:function(t,e){return A.postMessage({pathfinding:{operation:"start",payload:{width:t,height:e}}}),!0},setObstacles:function(t){return A.postMessage({pathfinding:{operation:"setObstacles",payload:{obstacles:t}}}),!0},findPath:function(t,e){return[[1,1]]},findPathAsync:function(t,e){return _.apply(this,arguments)}},I=(n(153),!1);function B(){return(B=Object(f.a)(h.a.mark((function t(){var e,n,r,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!I){t.next=2;break}return t.abrupt("return",Promise.resolve());case 2:return e=new Go,t.next=5,fetch("node_modules/go-pathfinding/build/go-pathfinding.wasm");case 5:return n=t.sent,t.next=8,n.arrayBuffer();case 8:return r=t.sent,t.next=11,WebAssembly.instantiate(r,e.importObject);case 11:a=t.sent,I=!0,e.run(a.instance);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(t,e){var n=window.findPath(t[0]/2,t[2]/2,e[0]/2,e[2]/2),r=[];if(n)for(var a=0,i=0;a<n.length;a+=2,i++)r[i]=[parseInt(n[a],10),parseInt(n[a+1],10)];return r}var q,R,W={initPathfinding:function(){return B.apply(this,arguments)},startPathFinding:function(t,e){return window.setGrid(t,e),!0},setObstacles:function(t){var e,n=t.reduce((function(t,e){var n=e.x,r=e.y;return t.push(n),t.push(r),t}),[]);return(e=window).setObstacles.apply(e,Object(p.a)(n)),!0},findPath:T,findPathAsync:function(t,e){return new Promise((function(n){n(T(t,e))}))}},D=n(131),G=1;function N(){return(N=Object(f.a)(h.a.mark((function t(){var e,n,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.a.instantiate(fetch("node_modules/assemblyscript-pathfinding/build/as-pathfinding.wasm"));case 2:return e=t.sent,n=e.exports,r=n.findPath,R=r,t.abrupt("return");case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function z(t,e){for(var n=R(q,Math.trunc(t[2]/2),Math.trunc(t[0]/2),Math.trunc(e[2]/2),Math.trunc(e[0]/2)),r=[],a=0;a<n.length-1;a+=2)r.push([n[a],n[a+1]]);return r}var L,J,U={initPathfinding:function(){return N.apply(this,arguments)},startPathFinding:function(t,e){return(q=new Int8Array(t*e+2))[0]=e,q[1]=t,G=e,!0},setObstacles:function(t){return t.forEach((function(t){var e=t.x,n=t.y;q[2+(n*G+e)]=1})),!0},findPath:z,findPathAsync:function(t,e){return new Promise((function(n,r){n(z(t,e))}))}},H=n(120),Q=1;function V(){return(V=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return J=H.findPath,t.abrupt("return",Promise.resolve());case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $(t,e){for(var n=J(L,Math.trunc(t[2]/2),Math.trunc(t[0]/2),Math.trunc(e[2]/2),Math.trunc(e[0]/2)),r=[],a=0;a<n.length-1;a+=2)r.push([n[a],n[a+1]]);return r}var K={initPathfinding:function(){return V.apply(this,arguments)},startPathFinding:function(t,e){return(L=new Int8Array(t*e+2))[0]=e,L[1]=t,Q=e,!0},setObstacles:function(t){return t.forEach((function(t){var e=t.x,n=t.y;L[2+(n*Q+e)]=1})),!0},findPath:$,findPathAsync:function(t,e){return new Promise((function(n,r){n($(t,e))}))}},X=(n(247),n(121));function Y(t){var e=Object(g.e)(X.a,"/pathfinding-demo/models/pine/scene.gltf"),n=e.nodes,r=e.materials,a=t.scale,i=void 0===a?[1,1,1]:a;n.tree_trunk001_0.geometry.computeBoundingBox();var o=n.tree_leaves001_0.geometry.boundingBox.min.z*i[1];return s.a.createElement("group",Object.assign({rotation:[-Math.PI/2,0,0]},t,{scale:i,dispose:null}),s.a.createElement("mesh",{geometry:n.tree_leaves001_0.geometry,position:[0,0,-o],castShadow:!0,receiveShadow:!0},s.a.createElement("meshPhysicalMaterial",{attach:"material",color:"green"})),s.a.createElement("mesh",{material:r["trunk.001"],geometry:n.tree_trunk001_0.geometry,position:[0,0,-o],castShadow:!0,receiveShadow:!0}))}var Z=n(80),tt=Object(i.memo)((function(t){var e=t.isWalking,n=void 0!==e&&e,r=Object(g.e)(Z.a,"/pathfinding-demo/models/player/BreathingIdle.fbx"),a=Object(g.e)(Z.a,"/pathfinding-demo/models/player/WalkForward.fbx");r.traverse((function(t){t.isMesh&&(t.castShadow=!0,t.receiveShadow=!0)}));var o=new m.AnimationMixer(r),c=o.clipAction(r.animations[0]),u=o.clipAction(a.animations[0]);Object(i.useEffect)((function(){n?(c.stop(),u.play()):(u.stop(),c.play())}),[n]);var h=new m.Clock;return Object(g.d)((function(){var t=h.getDelta();o.update(t)})),s.a.createElement("group",t,s.a.createElement("primitive",{object:r,scale:[.0075,.0075,.0075],position:[0,-.5,0],attach:"target"}))})),et=new P(50,50,10);W.initPathfinding(),U.initPathfinding(),K.initPathfinding(),Object(g.c)({OrbitControls:v.b});var nt=Object(i.memo)((function(t){var e=t.position,n=t.target,r=Object(i.useRef)(),a=Object(g.f)(),o=a.camera,c=a.gl;return Object(i.useEffect)((function(){o.lookAt(e),r.current&&r.current.target.copy(Object(d.a)(m.Vector3,Object(p.a)(n)))}),[e,n,r,o]),Object(g.d)((function(){r.current.update()})),s.a.createElement("orbitControls",{maxPolarAngle:Math.PI/3,minPolarAngle:Math.PI/3,args:[o,c.domElement],ref:r})})),rt=Object(i.memo)((function(t){var e=t.finder,n=Object(i.useState)([]),r=Object(l.a)(n,2),a=r[0],o=r[1];return Object(i.useEffect)((function(){var t=et.generate();o(t),e.setObstacles(t)}),[e]),s.a.createElement(i.Suspense,{fallback:s.a.createElement(s.a.Fragment,null)},a.map((function(t){var e=t.x,n=t.y,r=t.age;return s.a.createElement(Y,{position:[2*e+Math.random(),.2,2*n+Math.random()],scale:[.2+.1*r,.2+.1*r,.2+.1*r]})})))})),at=function(t){var e=t.points,n=t.target;return s.a.createElement(s.a.Fragment,null,s.a.createElement("mesh",{position:[n[0],-.5,n[2]],castShadow:!0},s.a.createElement("boxBufferGeometry",{attach:"geometry",args:[.25,.1,.25]}),s.a.createElement("meshPhysicalMaterial",{attach:"material",color:"darkgreen"})),e.slice(1).map((function(t){return s.a.createElement("mesh",{position:[2*t[1],-.5,2*t[0]],castShadow:!0},s.a.createElement("boxBufferGeometry",{attach:"geometry",args:[.25,.1,.25]}),s.a.createElement("meshPhysicalMaterial",{attach:"material",color:"green"}))})))},it=function(t){var e=t.handleClick,n=t.handleMove;return s.a.createElement("mesh",{rotation:[-Math.PI/2,0,0],position:[50,-.5,50],receiveShadow:!0,onClick:e,onPointerMove:n},s.a.createElement("planeBufferGeometry",{attach:"geometry",args:[100,100,100,100]}),s.a.createElement("meshPhysicalMaterial",{attach:"material",color:"darkgreen"}))},st=function(t){var e=t.position;return s.a.createElement(y.a,{makeDefault:!0,position:e,fov:15})},ot=function(){var t=Object(i.useState)([25,0,25]),e=Object(l.a)(t,2),n=e[0],r=(e[1],Object(i.useState)([25,0,25])),a=Object(l.a)(r,2),o=a[0],c=a[1],u=Object(i.useState)([60,5,75]),d=Object(l.a)(u,2),p=d[0],v=(d[1],Object(i.useState)([])),y=Object(l.a)(v,2),b=y[0],w=y[1],O=Object(i.useState)(!1),j=Object(l.a)(O,2),P=j[0],x=j[1],M=Object(i.useState)(!1),E=Object(l.a)(M,2),S=E[0],A=E[1],F=Object(i.useState)(!1),_=Object(l.a)(F,2),I=_[0],B=_[1],T=Object(i.useState)("threaded"),q=Object(l.a)(T,2),R=q[0],D=q[1],G=Object(i.useMemo)((function(){switch(R){case"js":return k;case"go":return W;case"assemblyscript":return U;case"assemblyscript compiled to js":return K;default:return C}}),[R]);function N(){return(N=Object(f.a)(h.a.mark((function t(e){var r,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!I){t.next=2;break}return t.abrupt("return");case 2:return B(!0),r=[e.point.x,e.point.y,e.point.z],c(r),t.next=7,G.findPathAsync(n,r);case 7:a=t.sent,B(!1),w(a);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(new m.Object3D).position.set(50,0,50),Object(i.useEffect)((function(){S&&G.startPathFinding(50,50)}),[S,G]),Object(i.useEffect)((function(){G.initPathfinding().then((function(){return A(!0)}))}),[G]),S&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"controls"},["js","threaded","go","assemblyscript","assemblyscript compiled to js"].map((function(t){return s.a.createElement("span",{className:"control ".concat(t===R?"selected":""),onClick:function(){return D(t)}},t)}))),s.a.createElement(g.a,{onCreated:function(t){var e=t.gl;e.shadowMap.enabled=!0,e.shadowMap.type=m.PCFSoftShadowMap}},s.a.createElement(st,{position:p}),s.a.createElement("ambientLight",{intensity:.75}),s.a.createElement("spotLight",{position:[50,10,50],penumbra:1,decay:2,castShadow:!0}),s.a.createElement(nt,{position:n,target:n}),s.a.createElement(i.Suspense,{fallback:s.a.createElement(s.a.Fragment,null)},s.a.createElement(tt,{position:n,isWalking:P})),s.a.createElement(i.Suspense,{fallback:s.a.createElement(s.a.Fragment,null)},s.a.createElement(it,{handleClick:function(t){x(!P)},handleMove:function(t){return N.apply(this,arguments)}})),s.a.createElement(rt,{finder:G}),s.a.createElement(at,{points:b,target:o})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(ot,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[132,1,2]]]);
//# sourceMappingURL=main.4fb43227.chunk.js.map